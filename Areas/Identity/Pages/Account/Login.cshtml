@page
@model LoginModel

@{
    ViewData["Title"] = "Log in";
}

@using Microsoft.Extensions.Options
@inject IOptions<GoogleCaptchaConfig> GoogleCaptchaConfig

<div class="flex w-full">
    <div class="left-to-right hidden lg:flex h-dvh w-1/2 items-center justify-center p-1">
        <div
            class="bg-[url('../images/black-and-white-leaf-810vk4fpm5babnuc.webp')] flex flex-col justify-end gap-4 p-10 rounded-xl bg-center bg-no-repeat bg-cover w-full h-full">
            <div
                class="bg-neutral-200/20 top-to-bottom !animation-delay-1000 flex w-full flex-col rounded-lg p-6 text-neutral-950 shadow-lg backdrop-blur-sm">
                <p class="mb-4 text-2xl">Login options</p>
                <p class="mb-2">Sign in with</p>
                <div class="flex flex-wrap gap-4">
                    <button type="button"
                        class="bg-neutral-200/20 rounded-lg px-4 py-2 shadow-lg hover:bg-neutral-200/30">
                        <i class="bi bi-google"></i>
                        Google
                    </button>
                    <button type="button"
                        class="bg-neutral-200/20 rounded-lg px-4 py-2 shadow-lg hover:bg-neutral-200/30">
                        <i class="bi bi-facebook"></i>
                        Facebook
                    </button>
                    <button type="button"
                        class="bg-neutral-200/20 rounded-lg px-4 py-2 shadow-lg hover:bg-neutral-200/30">
                        <i class="bi bi-microsoft"></i>
                        Microsoft
                    </button>
                    <button type="button"
                        class="bg-neutral-200/20 rounded-lg px-4 py-2 shadow-lg hover:bg-neutral-200/30">
                        <i class="bi bi-apple"></i>
                        Apple
                    </button>
                </div>
            </div>
            <div
                class="bg-neutral-200/20 top-to-bottom !animation-delay-900 flex w-full flex-col rounded-lg p-6 text-neutral-950 shadow-lg backdrop-blur-sm">
                <p class="mb-4 text-2xl">About us</p>
                <p>
                    Lorem ipsum dolor sit amet consectetur adipisicing elit. Aliquam consequatur ratione necessitatibus
                    neque aliquid quaerat provident omnis, magnam labore consectetur?
                </p>
            </div>
        </div>
    </div>
    <div class="right-to-left flex w-full lg:w-1/2 items-center justify-center">
        <div class="w-full sm:w-[30rem] h-dvh sm:h-auto sm:rounded-xl bg-neutral-300 px-8 sm:px-14 py-4 sm:py-8 shadow-xl">
            <h1 class="bottom-to-top !animation-delay-500 mb-14 select-none text-5xl text-neutral-700">
                @ViewData["Title"]
            </h1>
            <form method="post">
                <input hidden id="LoginViewModelToken" asp-for="Input.Token">
                <div class="flex flex-col gap-3">
                    <input asp-for="Input.Username" ;
                        class="bottom-to-top !animation-delay-500 w-full rounded-lg bg-white px-4 py-2 text-center text-neutral-900 shadow-lg outline-none"
                        autocomplete="off" placeholder="Username" />
                    <span asp-validation-for="Input.Username" class="-mt-3 ml-2 text-sm text-red-700"></span>
                    <div class="bottom-to-top !animation-delay-500 relative">
                        <input asp-for="Input.Password"
                            class="w-full rounded-lg bg-white px-4 py-2 text-center text-neutral-900 shadow-lg outline-none"
                            autocomplete="off" placeholder="Password" id="password-input" type="password" />
                        <button type="button"
                            class="absolute bottom-0 right-0 top-0 flex w-10 items-center justify-center rounded-e-lg bg-transparent hover:backdrop-brightness-75"
                            tabindex="-1" data-target="password-input" onclick="togglePasswordVisibility(this)">
                            <i class="bi bi-eye-fill"></i>
                        </button>
                    </div>
                    <span asp-validation-for="Input.Password" class="-mt-3 ml-2 text-sm text-red-700"></span>
                    <div class="bottom-to-top !animation-delay-500 mb-8 inline-flex items-center">
                        <label class="relative flex cursor-pointer items-center" for="check-1">
                            <input type="checkbox"
                                class="border-2 peer h-5 w-5 appearance-none rounded-md border-neutral-800 bg-neutral-300 shadow checked:bg-neutral-800 hover:shadow-md"
                                id="check-1" tabindex="-1" />
                            <span
                                class="opacity-0 -translate-x-1/2 -translate-y-1/2 absolute left-1/2 top-1/2 transform text-white peer-checked:opacity-100">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" viewBox="0 0 20 20"
                                    fill="currentColor" stroke="currentColor" stroke-width="1">
                                    <path fill-rule="evenodd"
                                        d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                        clip-rule="evenodd"></path>
                                </svg>
                            </span>
                        </label>
                        <label class="ml-2 cursor-pointer select-none text-sm text-neutral-800" for="check-1">
                            Remember me
                        </label>
                    </div>
                    <button type="submit" id="loginButton"
                        class="bottom-to-top !animation-delay-500 w-full rounded-lg bg-white px-4 py-2 text-lg shadow-lg">
                        Login
                    </button>
                    <div class="flex lg:hidden items-center justify-center gap-2 mt-4">
                        <p class="w-full h-[2px] bg-neutral-500"></p>
                        <p class="text-nowrap">Or sign in with</p>
                        <p class="w-full h-[2px] bg-neutral-500"></p>
                    </div>
                    <div class="flex lg:hidden justify-center gap-4 mb-4">
                        <button type="button"
                            class="bg-neutral-200/20 rounded-lg px-4 py-2 shadow-lg hover:bg-neutral-200/80">
                            <i class="bi bi-google"></i>
                        </button>
                        <button type="button"
                            class="bg-neutral-200/20 rounded-lg px-4 py-2 shadow-lg hover:bg-neutral-200/80">
                            <i class="bi bi-facebook"></i>
                        </button>
                        <button type="button"
                            class="bg-neutral-200/20 rounded-lg px-4 py-2 shadow-lg hover:bg-neutral-200/80">
                            <i class="bi bi-microsoft"></i>
                        </button>
                        <button type="button"
                            class="bg-neutral-200/20 rounded-lg px-4 py-2 shadow-lg hover:bg-neutral-200/80">
                            <i class="bi bi-apple"></i>
                        </button>

                    </div>
                    <div class="bottom-to-top !animation-delay-500">
                        <p class="text-center">
                            Don't have an account?
                            <a asp-page="./Register" class="text-blue-500 hover:text-blue-700" tabindex="-1"
                                asp-route-returnUrl="@Model.ReturnUrl">Register</a>
                        </p>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        function togglePasswordVisibility(button) {
            const inputId = button.getAttribute("data-target");
            const passwordInput = document.getElementById(inputId);
            const toggleIcon = button.querySelector("i");

            if (passwordInput.type === "password") {
                passwordInput.type = "text";
                toggleIcon.classList.remove("bi-eye-fill");
                toggleIcon.classList.add("bi-eye-slash-fill");
            } else {
                passwordInput.type = "password";
                toggleIcon.classList.remove("bi-eye-slash-fill");
                toggleIcon.classList.add("bi-eye-fill");
            }
        }
    </script>
    <script src="https://www.google.com/recaptcha/api.js?render=@GoogleCaptchaConfig.Value.SiteKey"></script>
    <script>
        function onClick(e) {
            e.preventDefault();

            grecaptcha.ready(function () {
                grecaptcha.execute('@GoogleCaptchaConfig.Value.SiteKey', { action: 'submit' }).then(function (token) {

                    document.getElementById("LoginViewModelToken").value = token;

                    document.querySelector('form').submit();
                });
            });
        }

        document.getElementById('loginButton').addEventListener('click', onClick);
    </script>

    <partial name="_ValidationScriptsPartial" />

}
